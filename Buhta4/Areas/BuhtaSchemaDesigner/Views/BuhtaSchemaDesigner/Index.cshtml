@model BuhtaSchemaDesignerModel

@{
    ViewBag.Title = "Index";
}


<nav class=" navbar navbar-default navbar-fixed-top navbar-static-top1">
    <div class="container container-fluid1">
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse">

            <form class="navbar-form navbar-left" role="search">
                <div href=# class="btn btn-default" id="aaaXXX">назад</div>
                <script>
                    $("#aaaXXX").on('click', function () {
                        if (window.opener) window.open('', window.opener.name).focus();
                    });</script>

            </form>



            <ul class="nav navbar-nav">
                <li><a href="#">Таблица</a></li>
                <li><a href="#columns">Колонки</a></li>
                <li><a href="#">Индексы</a></li>
                <li><a href="#links">Уроды</a></li>
                <li><a href="#">Индексы</a></li>
                <li><a href="#" id="qq">Отчеты</a></li>
            </ul>
            <script> $("#qq").on('click', function () { window.open('', 'parent').focus(); });</script>
            <form class="navbar-form navbar-right" role="search">

                @Html.bsButton(s =>
               {
                   //s.OnClick_Bind = nameof(Model.Test1ButtonClick);
                   s.Text = "Добавить";
                   s.Image = "Areas/BuhtaSchemaDesigner/Content/icon/button-insert.png";
                   s.ButtonStyle = bsButtonStyle.Default;
                   s.Size = bsButtonSize.Small;
               })

                @Html.bsButton(s =>
               {
                   s.OnClick_Bind = nameof(Model.OnChangeButtonClick);
                   s.Text = "Изменить";
                   s.Image = "Areas/BuhtaSchemaDesigner/Content/icon/button-update.png";
                   s.ButtonStyle = bsButtonStyle.Default;
                   s.Size = bsButtonSize.Small;
               })

                @Html.bsButton(s =>
               {
                   //s.OnClick_Bind = nameof(Model.Test1ButtonClick);
                   s.Text = "Удалить";
                   s.Image = "Areas/BuhtaSchemaDesigner/Content/icon/button-delete.png";

                   s.Size = bsButtonSize.Small;
                   s.ButtonStyle = bsButtonStyle.Default;
               })


            </form>

            <ul class="nav navbar-nav navbar-right">
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">SQL<span class="caret"></span></a>
                    <ul class="dropdown-menu">
                        <li><a href="#">Action</a></li>
                        <li><a href="#">Another action</a></li>
                        <li><a href="#">Something else here</a></li>
                        <li role="separator" class="divider"></li>
                        <li><a href="#">Separated link</a></li>
                        <li role="separator" class="divider"></li>
                        <li><a href="#">One more separated link</a></li>
                    </ul>
                </li>
            </ul>
        </div><!-- /.navbar-collapse -->
    </div><!-- /.container-fluid -->
</nav>

<div class="container">
    <h3>
        @*<img src="~/Areas/BuhtaCore/Content/icon/schema-table.png" />*@
        Дизайнер схемы
    </h3>

    @Html.bsInput(inp =>
{
    inp.Bind_Value(nameof(Model.TestProp1));
})

    @Html.bsTree1(tree =>
    {
        tree.Size = bsTreeSize.Default;

        tree.AddColumn(c =>
        {
            c.Caption = "Объект конфигурации";
            c.Field_Bind = "Name";
            c.AddStyle("color", "red");
            c.AddClass("cls12");
            c.CellTemplateJS = @"
 if (row.node.children) {
   row._ee=' ('+row.node.children.length.toString()+')'
   row._fontWeight='bold'
 }
 else
   row._fontWeight='normal';
";

            c.CellTemplate = "<span style='font-weight:{{_fontWeight}}'>{{Name}}</span>{{_ee}}";
        });

        tree.AddColumn(c =>
        {
            c.Hidden = true;
            c.Field_Bind = "RootClass";

        });

        tree.AddColumn(c =>
        {
            c.Caption = "Тип";
            c.Field_Bind = "RootType";
            c.AddStyle("color", "blue");
            c.AddClass("type-1");

        });

        tree.AddColumn(c =>
        {
            c.Caption = "ID";
            c.Field_Bind = "ID";
            c.CellTemplate = "<small style='opacity:0.3'>{{ID}}, {{RootClass}}</small>";

        });

        tree.DataSourceBinder = new bsTreeDataSourceToSqlDataViewBinder()
        {
            PropertyName = nameof(Model.SchemaObjectList),
            DisplayFieldName = "Name",
            KeyFieldName = "ID",
            ParentFieldName = "ParentObjectID"

        };

        tree.SelectedRows_Bind = nameof(Model.SelectedRows);

        tree.OnRowDoubleClick_Bind = nameof(Model.OnRowDoubleClick);
        //tree.OnRowSelect_Bind = nameof(Model.OnRowSelect);
        tree.OnRowActivate_Bind = nameof(Model.OnRowActivate);

    })
</div>


